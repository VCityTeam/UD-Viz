<!DOCTYPE html><html lang="en" style="font-size:16px"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link type="text/css" rel="stylesheet" href="custom.css"><title>Tutorial: Game getting started</title><!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]--><script src="scripts/third-party/hljs.js" defer="defer"></script><script src="scripts/third-party/hljs-line-num.js" defer="defer"></script><script src="scripts/third-party/popper.js" defer="defer"></script><script src="scripts/third-party/tippy.js" defer="defer"></script><script src="scripts/third-party/tocbot.min.js"></script><script>var baseURL="/",locationPathname="";baseURL=(locationPathname=document.location.pathname).substr(0,locationPathname.lastIndexOf("/")+1)</script><link rel="stylesheet" href="styles/clean-jsdoc-theme.min.css"><svg aria-hidden="true" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="display:none"><defs><symbol id="copy-icon" viewbox="0 0 488.3 488.3"><g><path d="M314.25,85.4h-227c-21.3,0-38.6,17.3-38.6,38.6v325.7c0,21.3,17.3,38.6,38.6,38.6h227c21.3,0,38.6-17.3,38.6-38.6V124    C352.75,102.7,335.45,85.4,314.25,85.4z M325.75,449.6c0,6.4-5.2,11.6-11.6,11.6h-227c-6.4,0-11.6-5.2-11.6-11.6V124    c0-6.4,5.2-11.6,11.6-11.6h227c6.4,0,11.6,5.2,11.6,11.6V449.6z"/><path d="M401.05,0h-227c-21.3,0-38.6,17.3-38.6,38.6c0,7.5,6,13.5,13.5,13.5s13.5-6,13.5-13.5c0-6.4,5.2-11.6,11.6-11.6h227    c6.4,0,11.6,5.2,11.6,11.6v325.7c0,6.4-5.2,11.6-11.6,11.6c-7.5,0-13.5,6-13.5,13.5s6,13.5,13.5,13.5c21.3,0,38.6-17.3,38.6-38.6    V38.6C439.65,17.3,422.35,0,401.05,0z"/></g></symbol><symbol id="search-icon" viewBox="0 0 512 512"><g><g><path d="M225.474,0C101.151,0,0,101.151,0,225.474c0,124.33,101.151,225.474,225.474,225.474    c124.33,0,225.474-101.144,225.474-225.474C450.948,101.151,349.804,0,225.474,0z M225.474,409.323    c-101.373,0-183.848-82.475-183.848-183.848S124.101,41.626,225.474,41.626s183.848,82.475,183.848,183.848    S326.847,409.323,225.474,409.323z"/></g></g><g><g><path d="M505.902,476.472L386.574,357.144c-8.131-8.131-21.299-8.131-29.43,0c-8.131,8.124-8.131,21.306,0,29.43l119.328,119.328    c4.065,4.065,9.387,6.098,14.715,6.098c5.321,0,10.649-2.033,14.715-6.098C514.033,497.778,514.033,484.596,505.902,476.472z"/></g></g></symbol><symbol id="font-size-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M11.246 15H4.754l-2 5H.6L7 4h2l6.4 16h-2.154l-2-5zm-.8-2L8 6.885 5.554 13h4.892zM21 12.535V12h2v8h-2v-.535a4 4 0 1 1 0-6.93zM19 18a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"/></symbol><symbol id="add-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M11 11V5h2v6h6v2h-6v6h-2v-6H5v-2z"/></symbol><symbol id="minus-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M5 11h14v2H5z"/></symbol><symbol id="dark-theme-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M10 7a7 7 0 0 0 12 4.9v.1c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2h.1A6.979 6.979 0 0 0 10 7zm-6 5a8 8 0 0 0 15.062 3.762A9 9 0 0 1 8.238 4.938 7.999 7.999 0 0 0 4 12z"/></symbol><symbol id="light-theme-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M12 18a6 6 0 1 1 0-12 6 6 0 0 1 0 12zm0-2a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM11 1h2v3h-2V1zm0 19h2v3h-2v-3zM3.515 4.929l1.414-1.414L7.05 5.636 5.636 7.05 3.515 4.93zM16.95 18.364l1.414-1.414 2.121 2.121-1.414 1.414-2.121-2.121zm2.121-14.85l1.414 1.415-2.121 2.121-1.414-1.414 2.121-2.121zM5.636 16.95l1.414 1.414-2.121 2.121-1.414-1.414 2.121-2.121zM23 11v2h-3v-2h3zM4 11v2H1v-2h3z"/></symbol><symbol id="reset-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M18.537 19.567A9.961 9.961 0 0 1 12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10c0 2.136-.67 4.116-1.81 5.74L17 12h3a8 8 0 1 0-2.46 5.772l.997 1.795z"/></symbol><symbol id="down-icon" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.7803 6.21967C13.0732 6.51256 13.0732 6.98744 12.7803 7.28033L8.53033 11.5303C8.23744 11.8232 7.76256 11.8232 7.46967 11.5303L3.21967 7.28033C2.92678 6.98744 2.92678 6.51256 3.21967 6.21967C3.51256 5.92678 3.98744 5.92678 4.28033 6.21967L8 9.93934L11.7197 6.21967C12.0126 5.92678 12.4874 5.92678 12.7803 6.21967Z"></path></symbol><symbol id="codepen-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M16.5 13.202L13 15.535v3.596L19.197 15 16.5 13.202zM14.697 12L12 10.202 9.303 12 12 13.798 14.697 12zM20 10.869L18.303 12 20 13.131V10.87zM19.197 9L13 4.869v3.596l3.5 2.333L19.197 9zM7.5 10.798L11 8.465V4.869L4.803 9 7.5 10.798zM4.803 15L11 19.131v-3.596l-3.5-2.333L4.803 15zM4 13.131L5.697 12 4 10.869v2.262zM2 9a1 1 0 0 1 .445-.832l9-6a1 1 0 0 1 1.11 0l9 6A1 1 0 0 1 22 9v6a1 1 0 0 1-.445.832l-9 6a1 1 0 0 1-1.11 0l-9-6A1 1 0 0 1 2 15V9z"/></symbol><symbol id="close-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M12 10.586l4.95-4.95 1.414 1.414-4.95 4.95 4.95 4.95-1.414 1.414-4.95-4.95-4.95 4.95-1.414-1.414 4.95-4.95-4.95-4.95L7.05 5.636z"/></symbol><symbol id="menu-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M3 4h18v2H3V4zm0 7h18v2H3v-2zm0 7h18v2H3v-2z"/></symbol></defs></svg></head><body class="dark" data-theme="dark"><div class="sidebar-container"><div class="sidebar" id="sidebar"><a href="/" class="sidebar-title sidebar-title-anchor">@ud-viz</a><div class="sidebar-items-container"><div class="sidebar-section-title with-arrow" data-isopen="false" id="MtdP-XJCgf6kuqtz7brtz"><div>Tutorials</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="tutorial-Architecture.html">Architecture</a></div><div class="sidebar-section-children"><a href="tutorial-Changelog.html">Changelog</a></div><div class="sidebar-section-children"><a href="tutorial-Contributors.html">Contributors</a></div><div class="sidebar-section-children"><a href="tutorial-Developers.html">Developers</a></div><div class="sidebar-section-children"><a href="tutorial-BrowserD2.html">BrowserD2</a></div><div class="sidebar-section-children"><a href="tutorial-BrowserSrcD2.html">BrowserSrcD2</a></div><div class="sidebar-section-children"><a href="tutorial-BrowserSrcFrame3D.html">BrowserSrcFrame3D</a></div><div class="sidebar-section-children"><a href="tutorial-BrowserSrcGame.html">BrowserSrcGame</a></div><div class="sidebar-section-children"><a href="tutorial-BrowserSrcGameD3.html">BrowserSrcGameD3</a></div><div class="sidebar-section-children"><a href="tutorial-BrowserSrcWidgetD3.html">BrowserSrcWidgetD3</a></div><div class="sidebar-section-children"><a href="tutorial-Node.html">Node</a></div><div class="sidebar-section-children"><a href="tutorial-SharedD3.html">SharedD3</a></div><div class="sidebar-section-children"><a href="tutorial-SharedSrcGame.html">SharedSrcGame</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="RtEWS51xMK9j78QK8M67W"><div>Global</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="global.html#printExec">printExec</a></div><div class="sidebar-section-children"><a href="global.html#printExec">printExec</a></div></div></div></div></div><div class="navbar-container" id="VuAckcnZhf"><nav class="navbar"><div class="navbar-left-items"><div class="navbar-item"><a id="Github" href="https://github.com/VCityTeam/UD-Viz" target="_blank">Github</a></div><div class="navbar-item"><a id="Examples" href="https://ud-viz.vcityliris.data.alpha.grandlyon.com/" target="_blank">Examples</a></div><div class="navbar-item"><a id="udvizHome" href="./" target="">udviz</a></div><div class="navbar-item"><a id="udvizBrowser" href="./browser" target="">udvizBrowser</a></div><div class="navbar-item"><a id="udvizShared" href="./shared" target="">udvizShared</a></div><div class="navbar-item"><a id="udvizNode" href="./node" target="">udvizNode</a></div></div><div class="navbar-right-items"><div class="navbar-right-item"><button class="icon-button search-button" aria-label="open-search"><svg><use xlink:href="#search-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button theme-toggle" aria-label="toggle-theme"><svg><use class="theme-svg-use" xlink:href="#light-theme-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button font-size" aria-label="change-font-size"><svg><use xlink:href="#font-size-icon"></use></svg></button></div></div><nav></nav></nav></div><div class="toc-container"><div class="toc-content"><span class="bold">On this page</span><div id="eed4d2a0bfd64539bb9df78095dec881"></div></div></div><div class="body-wrapper"><div class="main-content"><div class="main-wrapper"><section><header><h2>Game getting started</h2></header><article><h1 id="game">Game</h1><p>This document gives an overview of how the game part works. Here are some different implementations of the game part:</p><h2 id="prerequisites">Prerequisites</h2><ul><li>Run a back-end in node.js with express. See <a href="https://developer.mozilla.org/en-US/docs/Learn/Server-side/Express_Nodejs/Introduction">MDN DOC</a>.</li><li>See <a href="../../packages/browser/Readme.md#how-to-use-it-in-your-demo">here</a> how to import @ud-viz/browser framework.</li></ul><h2 id="creating-a-singleplayer-simple-game">Creating a singleplayer simple game</h2><p>The goal of this section is to learn how to set a singleplayer simple game structure:</p><p>You can see the final result of this tutorial ?todo to check where every code sample should be added (this example import @ud-viz/browser with bundle). &lt;== WIP</p><p><strong>Create a scene</strong></p><p>Initialize a <code>Frame3DPlanar</code> which creates a <a href="http://www.itowns-project.org/itowns/docs/#api/View/PlanarView">itowns PlanarView</a>.</p><pre class="prettyprint source lang-js"><code>// Define geographic extent: CRS, min/max X, min/max Y
const extent = new udvizBrowser.itowns.Extent(
  'EPSG:4326',
  1837816.94334,
  1847692.32501,
  5170036.4587,
  5178412.82698
);

const frame3DPlanar = new udvizBrowser.Frame3DPlanar(extent, {
  hasItownsControls: true,
});

</code></pre><p><strong>Create a <code>udvizBrowser.Game.External.SinglePlanarProcess</code></strong></p><p>Initialize a <code>SinglePlanarProcess</code>, gameObject3D defines your game model and <code>SinglePlanarProcess</code> is stepping your game over time.</p><pre class="prettyprint source lang-js"><code>const gameObject3D = new udvizBrowser.Shared.Game.Object3D({
  static: true,
});

const game = new udvizBrowser.Game.External.SinglePlanarProcess(
  gameObject3D,
  frame3DPlanar,
  new udvizBrowser.AssetManager(),
  new udvizBrowser.InputManager()
);

game.start();
</code></pre><p><strong>Add two types of script to your <code>udvizBrowser.Shared.Game.Object3D</code></strong></p><p>A game is composed of two contextsÂ <code>udvizBrowser.Shared.Game.Context</code> (handle collisions, add/remove gameobject3D, process commands, trigger <code>udvizBrowser.Shared.Game.ScriptBase</code> event, ...) and <code>udvizBrowser.Game.External.Context</code> (handle rendering, inputs of user, audio, trigger <code>udvizBrowser.Game.External.ScriptBase</code> event, ...)</p><blockquote><p>The game part is divided into two context to handle a multiplayer game. Typically the game external context is running on the client side and the game context is running on the server side. In this example both context are running on the client side (ie your web browser)</p></blockquote><pre class="prettyprint source lang-js"><code>const GameContextScript = class extends udvizBrowser.Shared.Game
.ScriptBase {
  init() {
    console.log('hello from game context');
  }
  static get ID_SCRIPT() {
    return 'game_context_script';
  }
};

const GameExternalContextScript = class extends udvizBrowser.Game.External
.ScriptBase {
  init() {
    console.log('hello from game external context ');
  }
  static get ID_SCRIPT() {
    return 'game_external_context_script';
  }
};

const gameObject3D = new udvizBrowser.Shared.Game.Object3D({
  static: true,
  components: {
    GameScript: {
      idScripts: [GameContextScript.ID_SCRIPT],
    },
    ExternalScript: {
      idScripts: [GameExternalContextScript.ID_SCRIPT],
    },
  },
});

const game = new udvizBrowser.Game.External.SinglePlanarProcess(
  gameObject3D,
  frame3DPlanar,
  new udvizBrowser.AssetManager(),
  new udvizBrowser.InputManager(),
  {
    gameScriptClass: [GameContextScript],
    externalGameScriptClass: [GameExternalContextScript],
    gameOrigin: { x: extent.center().x, y: extent.center().y, z: 100}
  }
);
</code></pre><p><strong>Spawn cubes</strong></p><p>In the <code>init</code> of <code>GameContextScript</code> add these lines</p><pre class="prettyprint source lang-js"><code>this.goCubes = [];
const extentCenter = extent.center();
setInterval(() => {
  const newGOCube = new udvizBrowser.Shared.Game.Object3D({
    components: {
      Render: {
        idRenderData: 'cube',
        color: [Math.random(), Math.random(), Math.random(), 1],
      },
    },
  });

  const size = Math.random() * 200 + 50;
  newGOCube.scale.set(size, size, size);
  this.goCubes.push(newGOCube);
  this.context.addObject3D(newGOCube);
}, 3000);
</code></pre><p><strong>Move cubes and remove them</strong></p><p>Add a <code>tick</code> method to your <code>GameContextScript</code></p><pre class="prettyprint source lang-js"><code>tick() {
  for (let index = this.goCubes.length - 1; index >= 0; index--) {
    const cube = this.goCubes[index];
    cube.position.z += 0.1 * this.context.dt;
    cube.setOutdated(true);// notify game external context that this gameobject need update 

    // sky is the limit
    if (cube.position.z > 2000) {
      this.context.removeObject3D(cube.uuid);
      this.goCubes.splice(index, 1);
    }
  }
}
</code></pre><p><strong>Send command</strong></p><p>Add in the <code>init</code> of <code>GameExternalContextScript</code> the following code</p><pre class="prettyprint source lang-js"><code>this.context.inputManager.addMouseCommand(
  'command_id',
  'click',
  () => {
    return new udvizBrowser.Shared.Command({
      type: 'toggle_pause',
    });
  }
);
</code></pre><p>This sends a command on the mouse click to <code>udvizBrowser.Shared.Game.Context</code>. Then in the <code>init</code> of <code>GameContextScript</code> add these lines:</p><pre class="prettyprint source lang-js"><code>this.pause = false;
setInterval(() => {
  if (this.pause) return;
  ...
</code></pre><p>In the <code>tick</code> of <code>GameContextScript</code></p><pre class="prettyprint source lang-js"><code>tick() {
  if (this.pause) return;
  ...
</code></pre><p>And finally add <code>onCommand</code> method:</p><pre class="prettyprint source lang-js"><code>onCommand(type) {
  if (type === 'toggle_pause') this.pause = !this.pause;
}
</code></pre><p>Now you have learned how to build a singleplayer simple game, let's see how to modify it to make a multiplayer one.</p><h2 id="create-a-multiplayer-simple-game-(wip)">Create a multiplayer simple game (WIP)</h2><p>1 Create a backend import udviz node with require as before run an express app running a http server Final result backend WIP</p><p>import game part of shared create a socket service by passsing the http server load gameobject3D where gameobject3D is the same one as the previous example the both script are unknown hard coded value of ids <em>to keep it simple</em> create another file gamethreadchild ok now you have to give the entry point to your thread the game script is the one running backend side copy paste it to your gamethread you have to give him the game script because he is going to run there replace udvizBrowser.Shared.Game by Game ouais backend okay</p><p>front end create a new html file base on previous one delete game script delete gameobject 3D Replace singleprocess by multiprocess create a socket io wrapper + connect it run enjoy</p><h2 id="examples">Examples</h2><p>Singleplayer one:</p><ul><li><a href="../../examples/ZeppelinGame.html">ZeppelinGame</a></li><li><a href="../../examples/AvatarGame.html">AvatarGame</a></li><li><a href="../../examples/DragAndDropAvatar.html">DragAndDropAvatar</a></li><li><a href="../../examples/AvatarGameShader.html">AvatarGameShader</a></li></ul><p>These examples require some knowledge of <a href="./ud_viz_shared/shared_game.md">@ud-viz/shared game</a> and <a href="./ud_viz_browser/browser_game.md">@ud-viz/browser game</a></p><p>Multiplayer one:</p><ul><li><a href="../../examples/MultiPlanarProcess.html">MultiPlanarProcess</a></li></ul><p>This example requires the same knowledge as singleplayer plus <a href="./ud_viz_node/node_game.md">@ud-viz/node game</a></p></article></section><footer class="footer" id="PeOAagUepe"><div class="wrapper">Fork: <a href="https://github.com/VCityTeam/UD-Viz">https://github.com/VCityTeam/UD-Viz</a></div></footer></div></div></div><div class="search-container" id="PkfLWpAbet" style="display:none"><div class="wrapper" id="iCxFxjkHbP"><button class="icon-button search-close-button" id="VjLlGakifb" aria-label="close search"><svg><use xlink:href="#close-icon"></use></svg></button><div class="search-box-c"><svg><use xlink:href="#search-icon"></use></svg> <input type="text" id="vpcKVYIppa" class="search-input" placeholder="Search..." autofocus></div><div class="search-result-c" id="fWwVHRuDuN"><span class="search-result-c-text">Type anything to view search result</span></div></div></div><div class="mobile-menu-icon-container"><button class="icon-button" id="mobile-menu" data-isopen="false" aria-label="menu"><svg><use xlink:href="#menu-icon"></use></svg></button></div><div id="mobile-sidebar" class="mobile-sidebar-container"><div class="mobile-sidebar-wrapper"><a href="/" class="sidebar-title sidebar-title-anchor">@ud-viz</a><div class="mobile-nav-links"><div class="navbar-item"><a id="Github-mobile" href="https://github.com/VCityTeam/UD-Viz" target="_blank">Github</a></div><div class="navbar-item"><a id="Examples-mobile" href="https://ud-viz.vcityliris.data.alpha.grandlyon.com/" target="_blank">Examples</a></div><div class="navbar-item"><a id="udvizHome-mobile" href="./" target="">udviz</a></div><div class="navbar-item"><a id="udvizBrowser-mobile" href="./browser" target="">udvizBrowser</a></div><div class="navbar-item"><a id="udvizShared-mobile" href="./shared" target="">udvizShared</a></div><div class="navbar-item"><a id="udvizNode-mobile" href="./node" target="">udvizNode</a></div></div><div class="mobile-sidebar-items-c"><div class="sidebar-section-title with-arrow" data-isopen="false" id="MtdP-XJCgf6kuqtz7brtz"><div>Tutorials</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="tutorial-Architecture.html">Architecture</a></div><div class="sidebar-section-children"><a href="tutorial-Changelog.html">Changelog</a></div><div class="sidebar-section-children"><a href="tutorial-Contributors.html">Contributors</a></div><div class="sidebar-section-children"><a href="tutorial-Developers.html">Developers</a></div><div class="sidebar-section-children"><a href="tutorial-BrowserD2.html">BrowserD2</a></div><div class="sidebar-section-children"><a href="tutorial-BrowserSrcD2.html">BrowserSrcD2</a></div><div class="sidebar-section-children"><a href="tutorial-BrowserSrcFrame3D.html">BrowserSrcFrame3D</a></div><div class="sidebar-section-children"><a href="tutorial-BrowserSrcGame.html">BrowserSrcGame</a></div><div class="sidebar-section-children"><a href="tutorial-BrowserSrcGameD3.html">BrowserSrcGameD3</a></div><div class="sidebar-section-children"><a href="tutorial-BrowserSrcWidgetD3.html">BrowserSrcWidgetD3</a></div><div class="sidebar-section-children"><a href="tutorial-Node.html">Node</a></div><div class="sidebar-section-children"><a href="tutorial-SharedD3.html">SharedD3</a></div><div class="sidebar-section-children"><a href="tutorial-SharedSrcGame.html">SharedSrcGame</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="RtEWS51xMK9j78QK8M67W"><div>Global</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="global.html#printExec">printExec</a></div><div class="sidebar-section-children"><a href="global.html#printExec">printExec</a></div></div></div><div class="mobile-navbar-actions"><div class="navbar-right-item"><button class="icon-button search-button" aria-label="open-search"><svg><use xlink:href="#search-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button theme-toggle" aria-label="toggle-theme"><svg><use class="theme-svg-use" xlink:href="#light-theme-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button font-size" aria-label="change-font-size"><svg><use xlink:href="#font-size-icon"></use></svg></button></div></div></div></div><script type="text/javascript" src="scripts/core.min.js"></script><script src="scripts/search.min.js" defer="defer"></script><script src="scripts/third-party/fuse.js" defer="defer"></script><script type="text/javascript">var tocbotInstance=tocbot.init({tocSelector:"#eed4d2a0bfd64539bb9df78095dec881",contentSelector:".main-content",headingSelector:"h1, h2, h3",hasInnerContainers:!0,scrollContainer:".main-content",headingsOffset:130,onClick:bringLinkToView})</script></body></html>