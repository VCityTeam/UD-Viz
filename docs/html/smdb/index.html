<!DOCTYPE html><html lang="en" style="font-size:16px"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link type="text/css" rel="stylesheet" href="custom.css"><title>Home</title><!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]--><script src="scripts/third-party/hljs.js" defer="defer"></script><script src="scripts/third-party/hljs-line-num.js" defer="defer"></script><script src="scripts/third-party/popper.js" defer="defer"></script><script src="scripts/third-party/tippy.js" defer="defer"></script><script src="scripts/third-party/tocbot.min.js"></script><script>var baseURL="/",locationPathname="";baseURL=(locationPathname=document.location.pathname).substr(0,locationPathname.lastIndexOf("/")+1)</script><link rel="stylesheet" href="styles/clean-jsdoc-theme.min.css"><svg aria-hidden="true" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="display:none"><defs><symbol id="copy-icon" viewbox="0 0 488.3 488.3"><g><path d="M314.25,85.4h-227c-21.3,0-38.6,17.3-38.6,38.6v325.7c0,21.3,17.3,38.6,38.6,38.6h227c21.3,0,38.6-17.3,38.6-38.6V124    C352.75,102.7,335.45,85.4,314.25,85.4z M325.75,449.6c0,6.4-5.2,11.6-11.6,11.6h-227c-6.4,0-11.6-5.2-11.6-11.6V124    c0-6.4,5.2-11.6,11.6-11.6h227c6.4,0,11.6,5.2,11.6,11.6V449.6z"/><path d="M401.05,0h-227c-21.3,0-38.6,17.3-38.6,38.6c0,7.5,6,13.5,13.5,13.5s13.5-6,13.5-13.5c0-6.4,5.2-11.6,11.6-11.6h227    c6.4,0,11.6,5.2,11.6,11.6v325.7c0,6.4-5.2,11.6-11.6,11.6c-7.5,0-13.5,6-13.5,13.5s6,13.5,13.5,13.5c21.3,0,38.6-17.3,38.6-38.6    V38.6C439.65,17.3,422.35,0,401.05,0z"/></g></symbol><symbol id="search-icon" viewBox="0 0 512 512"><g><g><path d="M225.474,0C101.151,0,0,101.151,0,225.474c0,124.33,101.151,225.474,225.474,225.474    c124.33,0,225.474-101.144,225.474-225.474C450.948,101.151,349.804,0,225.474,0z M225.474,409.323    c-101.373,0-183.848-82.475-183.848-183.848S124.101,41.626,225.474,41.626s183.848,82.475,183.848,183.848    S326.847,409.323,225.474,409.323z"/></g></g><g><g><path d="M505.902,476.472L386.574,357.144c-8.131-8.131-21.299-8.131-29.43,0c-8.131,8.124-8.131,21.306,0,29.43l119.328,119.328    c4.065,4.065,9.387,6.098,14.715,6.098c5.321,0,10.649-2.033,14.715-6.098C514.033,497.778,514.033,484.596,505.902,476.472z"/></g></g></symbol><symbol id="font-size-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M11.246 15H4.754l-2 5H.6L7 4h2l6.4 16h-2.154l-2-5zm-.8-2L8 6.885 5.554 13h4.892zM21 12.535V12h2v8h-2v-.535a4 4 0 1 1 0-6.93zM19 18a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"/></symbol><symbol id="add-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M11 11V5h2v6h6v2h-6v6h-2v-6H5v-2z"/></symbol><symbol id="minus-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M5 11h14v2H5z"/></symbol><symbol id="dark-theme-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M10 7a7 7 0 0 0 12 4.9v.1c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2h.1A6.979 6.979 0 0 0 10 7zm-6 5a8 8 0 0 0 15.062 3.762A9 9 0 0 1 8.238 4.938 7.999 7.999 0 0 0 4 12z"/></symbol><symbol id="light-theme-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M12 18a6 6 0 1 1 0-12 6 6 0 0 1 0 12zm0-2a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM11 1h2v3h-2V1zm0 19h2v3h-2v-3zM3.515 4.929l1.414-1.414L7.05 5.636 5.636 7.05 3.515 4.93zM16.95 18.364l1.414-1.414 2.121 2.121-1.414 1.414-2.121-2.121zm2.121-14.85l1.414 1.415-2.121 2.121-1.414-1.414 2.121-2.121zM5.636 16.95l1.414 1.414-2.121 2.121-1.414-1.414 2.121-2.121zM23 11v2h-3v-2h3zM4 11v2H1v-2h3z"/></symbol><symbol id="reset-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M18.537 19.567A9.961 9.961 0 0 1 12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10c0 2.136-.67 4.116-1.81 5.74L17 12h3a8 8 0 1 0-2.46 5.772l.997 1.795z"/></symbol><symbol id="down-icon" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.7803 6.21967C13.0732 6.51256 13.0732 6.98744 12.7803 7.28033L8.53033 11.5303C8.23744 11.8232 7.76256 11.8232 7.46967 11.5303L3.21967 7.28033C2.92678 6.98744 2.92678 6.51256 3.21967 6.21967C3.51256 5.92678 3.98744 5.92678 4.28033 6.21967L8 9.93934L11.7197 6.21967C12.0126 5.92678 12.4874 5.92678 12.7803 6.21967Z"></path></symbol><symbol id="codepen-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M16.5 13.202L13 15.535v3.596L19.197 15 16.5 13.202zM14.697 12L12 10.202 9.303 12 12 13.798 14.697 12zM20 10.869L18.303 12 20 13.131V10.87zM19.197 9L13 4.869v3.596l3.5 2.333L19.197 9zM7.5 10.798L11 8.465V4.869L4.803 9 7.5 10.798zM4.803 15L11 19.131v-3.596l-3.5-2.333L4.803 15zM4 13.131L5.697 12 4 10.869v2.262zM2 9a1 1 0 0 1 .445-.832l9-6a1 1 0 0 1 1.11 0l9 6A1 1 0 0 1 22 9v6a1 1 0 0 1-.445.832l-9 6a1 1 0 0 1-1.11 0l-9-6A1 1 0 0 1 2 15V9z"/></symbol><symbol id="close-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M12 10.586l4.95-4.95 1.414 1.414-4.95 4.95 4.95 4.95-1.414 1.414-4.95-4.95-4.95 4.95-1.414-1.414 4.95-4.95-4.95-4.95L7.05 5.636z"/></symbol><symbol id="menu-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M3 4h18v2H3V4zm0 7h18v2H3v-2zm0 7h18v2H3v-2z"/></symbol></defs></svg></head><body data-theme="dark"><div class="sidebar-container"><div class="sidebar" id="sidebar"><a href="/" class="sidebar-title sidebar-title-anchor">@ud-viz/smdb</a><div class="sidebar-items-container"><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-classes"><div>Classes</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="AuthenticationView.html">AuthenticationView</a></div><div class="sidebar-section-children"><a href="ContributeModule.html">ContributeModule</a></div><div class="sidebar-section-children"><a href="ContributeService.html">ContributeService</a></div><div class="sidebar-section-children"><a href="DefaultDocumentSource.html">DefaultDocumentSource</a></div><div class="sidebar-section-children"><a href="Document.html">Document</a></div><div class="sidebar-section-children"><a href="DocumentCommentsModule.html">DocumentCommentsModule</a></div><div class="sidebar-section-children"><a href="DocumentCommentsService.html">DocumentCommentsService</a></div><div class="sidebar-section-children"><a href="DocumentCommentsWindow.html">DocumentCommentsWindow</a></div><div class="sidebar-section-children"><a href="DocumentCreationWindow.html">DocumentCreationWindow</a></div><div class="sidebar-section-children"><a href="DocumentFilter.html">DocumentFilter</a></div><div class="sidebar-section-children"><a href="DocumentInspectorWindow.html">DocumentInspectorWindow</a></div><div class="sidebar-section-children"><a href="DocumentModule.html">DocumentModule</a></div><div class="sidebar-section-children"><a href="DocumentNavigatorWindow.html">DocumentNavigatorWindow</a></div><div class="sidebar-section-children"><a href="DocumentProvider.html">DocumentProvider</a></div><div class="sidebar-section-children"><a href="DocumentSearchFilter.html">DocumentSearchFilter</a></div><div class="sidebar-section-children"><a href="DocumentService.html">DocumentService</a></div><div class="sidebar-section-children"><a href="DocumentSource.html">DocumentSource</a></div><div class="sidebar-section-children"><a href="DocumentUpdateWindow.html">DocumentUpdateWindow</a></div><div class="sidebar-section-children"><a href="DocumentValidationModule.html">DocumentValidationModule</a></div><div class="sidebar-section-children"><a href="DocumentView.html">DocumentView</a></div><div class="sidebar-section-children"><a href="DocumentVisualizerWindow.html">DocumentVisualizerWindow</a></div><div class="sidebar-section-children"><a href="DocumentsInValidationDocumentSource.html">DocumentsInValidationDocumentSource</a></div><div class="sidebar-section-children"><a href="GuidedTour.html">GuidedTour</a></div><div class="sidebar-section-children"><a href="GuidedTourController.html">GuidedTourController</a></div><div class="sidebar-section-children"><a href="ValidationService.html">ValidationService</a></div><div class="sidebar-section-children"><a href="ValidationView.html">ValidationView</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-tutorials"><div>Tutorials</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="tutorial-Changelog.html">Changelog</a></div><div class="sidebar-section-children"><a href="tutorial-Contributing.html">Contributing</a></div><div class="sidebar-section-children"><a href="tutorial-Contributors.html">Contributors</a></div><div class="sidebar-section-children"><a href="tutorial-Definitions.html">Definitions</a></div><div class="sidebar-section-children"><a href="tutorial-Developers.html">Developers</a></div><div class="sidebar-section-children"><a href="tutorial-ReleasePublish.html">ReleasePublish</a></div><div class="sidebar-section-children"><a href="tutorial-Reproducibility.html">Reproducibility</a></div><div class="sidebar-section-children"><a href="tutorial-architecture.html">architecture</a></div><div class="sidebar-section-children"><a href="tutorial-game.html">game</a></div><div class="sidebar-section-children"><a href="tutorial-how_to_import.html">how_to_import</a></div><div class="sidebar-section-children"><a href="tutorial-initial_camera_transform.html">initial_camera_transform</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-global"><div>Global</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="global.html#AuthenticationService">AuthenticationService</a></div><div class="sidebar-section-children"><a href="global.html#cbAccepts">cbAccepts</a></div><div class="sidebar-section-children"><a href="global.html#cbAction">cbAction</a></div></div></div></div></div><div class="navbar-container" id="VuAckcnZhf"><nav class="navbar"><div class="navbar-left-items"><div class="navbar-item"><a id="Github" href="https://github.com/VCityTeam/UD-Viz" target="_blank">Github</a></div><div class="navbar-item"><a id="Examples" href="https://ud-viz.vcityliris.data.alpha.grandlyon.com/" target="_blank">Examples</a></div><div class="navbar-item"><a id="udvizHome" href="../" target="">udviz</a></div><div class="navbar-item"><a id="udviz/extensions_3d_tiles_temporal" href="../extensions_3d_tiles_temporal" target="">udviz/extensions_3d_tiles_temporal</a></div><div class="navbar-item"><a id="udviz/frame3d" href="../frame3d" target="">udviz/frame3d</a></div><div class="navbar-item"><a id="udviz/game_browser" href="../game_browser" target="">udviz/game_browser</a></div><div class="navbar-item"><a id="udviz/game_browser_template" href="../game_browser_template" target="">udviz/game_browser_template</a></div><div class="navbar-item"><a id="udviz/game_editor" href="../game_editor" target="">udviz/game_editor</a></div><div class="navbar-item"><a id="udviz/game_node" href="../game_node" target="">udviz/game_node</a></div><div class="navbar-item"><a id="udviz/game_node_template" href="../game_node_template" target="">udviz/game_node_template</a></div><div class="navbar-item"><a id="udviz/game_shared" href="../game_shared" target="">udviz/game_shared</a></div><div class="navbar-item"><a id="udviz/game_shared_template" href="../game_shared_template" target="">udviz/game_shared_template</a></div><div class="navbar-item"><a id="udviz/show_room" href="../show_room" target="">udviz/show_room</a></div><div class="navbar-item"><a id="udviz/smdb" href="../smdb" target="">udviz/smdb</a></div><div class="navbar-item"><a id="udviz/utils_browser" href="../utils_browser" target="">udviz/utils_browser</a></div><div class="navbar-item"><a id="udviz/utils_node" href="../utils_node" target="">udviz/utils_node</a></div><div class="navbar-item"><a id="udviz/utils_shared" href="../utils_shared" target="">udviz/utils_shared</a></div><div class="navbar-item"><a id="udviz/visualizer" href="../visualizer" target="">udviz/visualizer</a></div><div class="navbar-item"><a id="udviz/widget_3d_tiles" href="../widget_3d_tiles" target="">udviz/widget_3d_tiles</a></div><div class="navbar-item"><a id="udviz/widget_base_map" href="../widget_base_map" target="">udviz/widget_base_map</a></div><div class="navbar-item"><a id="udviz/widget_bookmark" href="../widget_bookmark" target="">udviz/widget_bookmark</a></div><div class="navbar-item"><a id="udviz/widget_camera_positioner" href="../widget_camera_positioner" target="">udviz/widget_camera_positioner</a></div><div class="navbar-item"><a id="udviz/widget_extensions_3d_tiles_temporal" href="../widget_extensions_3d_tiles_temporal" target="">udviz/widget_extensions_3d_tiles_temporal</a></div><div class="navbar-item"><a id="udviz/widget_geocoding" href="../widget_geocoding" target="">udviz/widget_geocoding</a></div><div class="navbar-item"><a id="udviz/widget_guided_tour" href="../widget_guided_tour" target="">udviz/widget_guided_tour</a></div><div class="navbar-item"><a id="udviz/widget_layer_choice" href="../widget_layer_choice" target="">udviz/widget_layer_choice</a></div><div class="navbar-item"><a id="udviz/widget_legonizer" href="../widget_legonizer" target="">udviz/widget_legonizer</a></div><div class="navbar-item"><a id="udviz/widget_planar_controls" href="../widget_planar_controls" target="">udviz/widget_planar_controls</a></div><div class="navbar-item"><a id="udviz/widget_slide_show" href="../widget_slide_show" target="">udviz/widget_slide_show</a></div><div class="navbar-item"><a id="udviz/widget_sparql" href="../widget_sparql" target="">udviz/widget_sparql</a></div><div class="navbar-item"><a id="udviz/widget_versioning" href="../widget_versioning" target="">udviz/widget_versioning</a></div><div class="navbar-item"><a id="udviz/widget_workspace" href="../widget_workspace" target="">udviz/widget_workspace</a></div></div><div class="navbar-right-items"><div class="navbar-right-item"><button class="icon-button search-button" aria-label="open-search"><svg><use xlink:href="#search-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button theme-toggle" aria-label="toggle-theme"><svg><use class="theme-svg-use" xlink:href="#light-theme-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button font-size" aria-label="change-font-size"><svg><use xlink:href="#font-size-icon"></use></svg></button></div></div><nav></nav></nav></div><div class="toc-container"><div class="toc-content"><span class="bold">On this page</span><div id="eed4d2a0bfd64539bb9df78095dec881"></div></div></div><div class="body-wrapper"><div class="main-content"><div class="main-wrapper"><section class="readme"><article><h1 id="%40ud-viz%2Fsmdb">@ud-viz/smdb</h1><p><a href="https://npmjs.com/package/@ud-viz/smdb"><img src="https://badgen.net/npm/v/@ud-viz/smdb" alt="NPM package version"></a></p><h1 id="old-documentation">OLD DOCUMENTATION</h1><h1 id="documents-module">Documents Module</h1><p>The documents module is responsible for managing and display documents. Its purpose is to retrieve documents from a server, filter them to have a restrain list, display this list and allow the use to navigate inside (by seeing the details of each document).</p><p>The module is also extensible, which means that other modules can serve as plug-ins extending the functionnalities of the documents module. They can to that in many ways :</p><ul><li>Change the source of documents</li><li>Apply new filters</li><li>Add a window to display</li><li>Modify the navigator and/or the inspector windows to add elements such as text, buttons, etc.</li></ul><h2 id="basic-functionalities">Basic functionalities</h2><p>In the <a href="../../examples/smdb.html">example</a>, you can view how to implement this modules. It can:</p><ul><li>Fetch all documents from the server. It's actually the default comportement (and may change in the future for scaling purpose). The user can filter the retrieved list according to some filters: keywords in the title/description, subject, publication or refering date.</li><li>Display the details of one particular documents, and navigate through the documents list. The navigation can be done either by selecting a document in the document list, or by using navigation arrows in the document inspector.</li></ul><p><img src="./img/view.png" alt="The look of the documents module"></p><p>The demo also includes the <code>DocumentVisualizer</code> module, that adds an &quot;Orient&quot; button in the document inspector. When pressed, the button moves the camera to the &quot;visualization&quot; position specified in the document, and the image of the document is displayed in superposition to the scene.</p><h2 id="usage">Usage</h2><p>Adding the documents module in a demo is pretty simple :</p><pre class="prettyprint source lang-js"><code>////// DOCUMENTS MODULE
const documentModule = new udvcore.DocumentModule(
  requestService,
  baseDemo.config
);
baseDemo.addWidgetView('documents', documentModule.view);

////// DOCUMENTS VISUALIZER (to orient the document)
const imageOrienter = new udvcore.DocumentVisualizerWindow(
  documentModule,
  baseDemo.view,
  baseDemo.controls
);
</code></pre><p>In this example, we actually add the document visualizer in addition to the documents module.</p><h3 id="required-configuration">Required configuration</h3><p>The minimal configuration required to make the documents module work is the following :</p><pre class="prettyprint source lang-json"><code>{
  &quot;type&quot;: &quot;class&quot;,
  &quot;server&quot;: {
    &quot;url&quot;: &quot;http://localhost:1525/&quot;,
    &quot;document&quot;: &quot;document&quot;,
    &quot;file&quot;: &quot;file&quot;
  }
}
</code></pre><p><code>server.url</code> represents the base URL for the server. The documents service expects it to be a REST API, where access routes are in the form <code>{baseURL}/{document}</code> for documents (e.g. &quot;http://localhost:1525/document&quot;) and <code>{baseURL}/{document}/{id}/{file}</code> for files associated with documents (e.g. &quot;http://localhost:1525/document/1/file&quot; for the file associated with the document of ID 1).</p><h3 id="dependencies">Dependencies</h3><p>The documents module depends on the utility <code>RequestService</code> to perform HTTP requests, and require the demo configuration to get the server addresses.</p><p>The document visualizer depends on the documents module, and the iTowns view and camera controls from the demo.</p><p><img src="./img/dependencies.png" alt="Dependencies graph"></p><h2 id="code-architecture">Code architecture</h2><p>The code architectures follows an <a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93viewmodel">MVVM</a> architectural pattern.</p><ul><li>The model is responsible for holding the documents. It fetches them from the server and store them in a list. The objects responsible for making the requests are the <code>DocumentService</code> and the <code>DocumentSource</code>.</li><li>The view model serves as an interface between the view and the model. It holds a <code>DocumentProvider</code> that retrieve the document list fetched by the model, and dispatch it into two types of documents. First, the filtered documents is a smaller list of documents reduced according to some filters (which are istances of <code>DocumentFilter</code>). Second, it holds a reference to the &quot;displayed document&quot; which is one particular document in the filtered documents list.</li><li>The view is responsible to display the data in the view model and react to user input. It has two windows : a navigator window that holds a form corresponding to search filters and displays the filtered documents list. It also has a inspector window that shows the displayed document. In the code, the view is separated into three classes : the <code>DocumentView</code> holds a reference to the two windows, <code>DocumentNavigatorWindow</code> and <code>DocumentInspector</code>.</li></ul><h2 id="extensions">Extensions</h2><p>In this part, we are explaining how other modules can extend the functionnalities of the document module by serving as &quot;plug-ins&quot;.</p><p>A module that wishes to extend the documents module should take a <code>DocumentModule</code> object in its constructor. This object is the root of the module and provide a direct access to the instances of the view, view model and the model. However, an extending module should only uses methods from the <code>DocumentModule</code> in order to correctly work. The only exception is the windows that extends <code>AbstractDocumentWindow</code>, which are given access to the view model and the view.</p><h3 id="adding-visual-elements">Adding visual elements</h3><p>Adding visual interface elements to the view can be done in two ways :</p><ul><li>Extending one of the navigator or inspector window.</li><li>Adding a new window.</li></ul><h4 id="extending-the-navigator-or-inspector-window">Extending the navigator or inspector window</h4><p>Extending one the existing windows can be done pretty easily from the <code>DocumentModule</code>:</p><pre class="prettyprint source lang-js"><code>documentModule.addInspectorExtension('MyExtension', {
  type: 'button',
  container: 'left',
  html: 'Click here to show the title !',
  callback: (doc) => {
    alert('The title of the current document is : ' + doc.title);
  },
});
</code></pre><p>In this example, we add a button (<code>type: 'button'</code>) in the inspector window. Its text shall be 'Click here to show the title !' and when clicked, it displays the title of the displayed document.</p><p>We also pass a <code>container</code> parameter that specifies where in the window the button should be added. In this example, it will be added in the &quot;left&quot; side of the buttons section. To see available containers, please refer to the <code>addInspectorExtension</code> documentation.</p><p>As you can see, adding an extension is done by providing a descriptive object that specifies a type, the HTML content and eventually a callback. For the moment, only two types are supported : 'button' which is a button that triggers a callback, and 'panel' which is simply a chunk of static HTML.</p><pre class="prettyprint source lang-js"><code>documentModule.addInspectorExtension('MyExtension', {
  type: 'div',
  html: `
    &lt;h3>My Extension&lt;/h3>
    &lt;p>
      The title of the document is : &lt;span id=&quot;title&quot;>&lt;/span>
    &lt;/p>
  `,
});
documentModule.addEventListener(
  DocumentModule.EVENT_DISPLAYED_DOC_CHANGED,
  (doc) => {
    document.getElementById('title').innerText = doc.title;
  }
);
</code></pre><p>In this example, we create a new section in the inspector window that keeps track of the document title. We do this by passing a string of HTML, in which a <code>span</code> tag has a specific 'title' ID that we can use later. We then adds an event listener so that when the currently displayed document change, our custom section will update and render the title.</p><p>You notice that no <code>container</code> value has been passed in parameter. That's because our inspector window currently has only one container available for panels, so the parameter is optional.</p><p>The <code>addInspectorExtension</code> also has an equivalent for the navigator window, which is called <code>addNavigatorExtension</code>. It has the same behaviour, except one difference for the buttons elements : the callback does not pass the displayed document as parameter, but the list of filtered documents.</p><h4 id="adding-a-new-window">Adding a new window</h4><p>The addition of a new window for documents is made through the <code>AbstractDocumentWindow</code> class (in the <code>View</code> folder) that represents a window responsible for displaying document data, and interacting with the document provider. The base code inside the extending window should look like like this :</p><pre class="prettyprint source lang-js"><code>export class ExtensionWindow extends AbstractDocumentWindow {
  constructor() {
    super('Extension Name');
  }

  get innerContentHtml() {
    return /*html*/ `

    `;
  }

  windowCreated() {
    this.hide();
  }

  documentWindowReady() {}
}
</code></pre><p>This window is empty and does nothing. In fact, it doesn't event displays as we specified <code>this.hide()</code> when the window is created. This will allow us to display the window when the user clicks on a button in the document inspector for example, but we'll see that in a few paragraphs. For the moment, let's just register our new window :</p><pre class="prettyprint source lang-js"><code>// MyModule.js
let myWindow = new ExtensionWindow();
documentModule.addDocumentWindow(myWindow);
</code></pre><p>This code tells the view to register the new document window in its windows list. We can also do this in the <code>ExtensionWindow</code> by taking the documents module as parameter of the constructor :</p><pre class="prettyprint source lang-js"><code>// ExtensionWindow.js
constructor(documentModule) {
  documentModule.addDocumentWindow(this);
}

// MyModule.js
let myWindow = new ExtensionWindow(documentModule);
</code></pre><p>Now that we've done that, what actually changed is that our window has access to the view and the view model of the documents module. It has two members, <code>view</code> and <code>provider</code> refering to the <code>DocumentView</code> and the <code>DocumentProvider</code>. They are not warranted to be instantiated right at the beginning, but we provide a hook function that triggers when these two elements are set :</p><pre class="prettyprint source lang-js"><code>documentWindowReady() {
  // `provider` and `view` are now usable
  this.provider.addEventListener(DocumentProvider.EVENT_FILTERED_DOCS_UPDATED,
    (docs) => {});
  this.provider.addEventListener(DocumentProvider.EVENT_DISPLAYED_DOC_CHANGED,
    (doc) => {});
}
</code></pre><p>Now we need to add a button to actually display our window. Let's say we want to add this button in the document inspector. All we need to do is the following :</p><pre class="prettyprint source lang-js"><code>documentModule.addInspectorExtension('MyExtension', {
  type: 'button',
  html: 'Show my window',
  callback: () => myWindow.requestDisplay(),
});
</code></pre><p>The <code>requestDisplay</code> methods tells the view to display the specified window.</p><h3 id="interacting-with-the-model">Interacting with the model</h3><p>An external module has two ways of interacting with the model : changing the source of documents, and adding custom filters.</p><h4 id="changing-the-source">Changing the source</h4><p>Changing the document source means changing the server configuration. This is done by instantiating a <code>DocumentSource</code> object with the correct parameters. One way of doing that is to create a custom objects that inherits this class :</p><pre class="prettyprint source lang-js"><code>export class MyCustomSource extends DocumentSource {
  constructor(config) {
    super();

    this.myCustomUrl = `${config.customUrl}${config.customDocs}`;
    this.fileRoute = config.customFiles;
  }

  getDocumentUrl() {
    return this.myCustomUrl;
  }

  getImageUrl(doc) {
    return this.myCustomUrl + '/' + doc.id + '/' + this.imageRoute;
  }
}
</code></pre><p>Here, we suppose that the UD-Viz configuration has an object like this :</p><pre class="prettyprint source lang-json"><code>{
  &quot;customUrl&quot;: &quot;http://custom-url.com/&quot;,
  &quot;customDocs&quot;: &quot;my-documents&quot;,
  &quot;customFiles&quot;: &quot;my-file&quot;
}
</code></pre><p>So, by using the source we provided, the document service will now retrieve the documents using the URL returned by <code>getDocumentUrl</code> (in this case, it will be <code>http://custom-url.com/my-documents</code>) and document files using <code>getImageUrl</code> (in our example, <code>http://custom-url.com/my-documents/{id}/my-file</code>).</p><p>To change the document source, we can use the <code>changeDocumentSource</code> method of the documents module :</p><pre class="prettyprint source lang-js"><code>let mySource = new MyCustomSource(config);
documentModule.changeDocumentSource(mySource, true);
</code></pre><p>The second parameter indicates that authentication should be used with this source.</p><h4 id="adding-filters">Adding filters</h4><p>The other way of changing the document list is by adding new filters. This is done by providing an instance of the <code>DocumentFilter</code> class. A filter in its simplest form is basically a function that takes a document in input, and returns a boolean indicating wether the filters &quot;accepts&quot; the document. If yes, the document will be kept in the filtered document list, otherwise it will not appear in the list.</p><p>Let's construct a filter that only keeps documents that have a title with less than 3 words :</p><pre class="prettyprint source lang-js"><code>let titleFilter = new DocumentFilter((doc) => {
  let wordCount = doc.title.split(' ').length;
  return wordCount &lt; 3;
});

documentModule.addFilter(titleFilter);
</code></pre><p>Creating our filter is really simple : we only need to instantiate a <code>DocumentFilter</code> object and pass the acceptation function to it. In this example, we use an arrow function that captures the context in which it was created. This allows us to make dynamic filters, like this one :</p><pre class="prettyprint source lang-js"><code>this.maxWordCount = 3;

let titleFilter = new DocumentFilter((doc) => {
  let wordCount = doc.title.split(' ').length;
  return wordCount &lt; this.maxWordCount;
});

documentModule.addFilter(titleFilter);

// Later, we can change our filter
this.maxWordCount = 5;
documentModule.refreshDocumentList();
</code></pre><p>In this example, we only keep documents that have a title with less than N words, where N is determined by the <code>maxWordCount</code> variable. This means that our filter is dynamic and can be updated anytime during the execution. This also means that we can deactivate our filter, by specifying :</p><pre class="prettyprint source lang-js"><code>this.maxWordCount = Infinity;
</code></pre><p>As there will always be a finite number of words in a document title, the filter will let all documents pass.</p><h3 id="contribute">Contribute</h3><ul><li>Possibility to create a new document</li><li>Possibility to edit and delete existing documents</li></ul><p><a href="https://github.com/sophiaab/UDV/tree/new_contribute/UDV-Shared/src/Extensions/Contribute/example">Demo</a></p><h3 id="about-the-demo">About the demo</h3><p>The document-related functionalities of this demo have been generated from the file 'contributeConfig.json'.</p><p>It is used to configure dependencies towards an external data server, as well as the following UD-Viz (document-related) views:</p><ul><li>Document browser</li><li>Document creation</li><li>Document research</li></ul><p>See how to set the configuration: https://github.com/MEPP-team/VCity/wiki/Configuring-UDV</p><p>In this particular demo, a document is defined by the following attributes:</p><p>Metadata:</p><ul><li>title</li><li>description</li><li>referring date</li><li>publication date</li><li>type</li><li>subject</li></ul><p>Visualization:</p><ul><li>positionX, positionY, positionZ</li><li>quaternionX, quaternionY, quaternionZ, quaternionW</li></ul><p>In this demo, all attributes are mandatory. They have to be set by the user when he wishes to create a new document. This is a choice of configuration for this demo. It is also possible to define optional attributes.</p><p>All attributes in 'metadata' are displayed in the browser.</p><p>Attributes having their &quot;queryable&quot; property set to &quot;true&quot; or to &quot;keyword&quot; can be queried.</p></article></section><footer class="footer" id="PeOAagUepe"><div class="wrapper">Fork: <a href="https://github.com/VCityTeam/UD-Viz">https://github.com/VCityTeam/UD-Viz</a></div></footer></div></div></div><div class="search-container" id="PkfLWpAbet" style="display:none"><div class="wrapper" id="iCxFxjkHbP"><button class="icon-button search-close-button" id="VjLlGakifb" aria-label="close search"><svg><use xlink:href="#close-icon"></use></svg></button><div class="search-box-c"><svg><use xlink:href="#search-icon"></use></svg> <input type="text" id="vpcKVYIppa" class="search-input" placeholder="Search..." autofocus></div><div class="search-result-c" id="fWwVHRuDuN"><span class="search-result-c-text">Type anything to view search result</span></div></div></div><div class="mobile-menu-icon-container"><button class="icon-button" id="mobile-menu" data-isopen="false" aria-label="menu"><svg><use xlink:href="#menu-icon"></use></svg></button></div><div id="mobile-sidebar" class="mobile-sidebar-container"><div class="mobile-sidebar-wrapper"><a href="/" class="sidebar-title sidebar-title-anchor">@ud-viz/smdb</a><div class="mobile-nav-links"><div class="navbar-item"><a id="Github-mobile" href="https://github.com/VCityTeam/UD-Viz" target="_blank">Github</a></div><div class="navbar-item"><a id="Examples-mobile" href="https://ud-viz.vcityliris.data.alpha.grandlyon.com/" target="_blank">Examples</a></div><div class="navbar-item"><a id="udvizHome-mobile" href="../" target="">udviz</a></div><div class="navbar-item"><a id="udviz/extensions_3d_tiles_temporal-mobile" href="../extensions_3d_tiles_temporal" target="">udviz/extensions_3d_tiles_temporal</a></div><div class="navbar-item"><a id="udviz/frame3d-mobile" href="../frame3d" target="">udviz/frame3d</a></div><div class="navbar-item"><a id="udviz/game_browser-mobile" href="../game_browser" target="">udviz/game_browser</a></div><div class="navbar-item"><a id="udviz/game_browser_template-mobile" href="../game_browser_template" target="">udviz/game_browser_template</a></div><div class="navbar-item"><a id="udviz/game_editor-mobile" href="../game_editor" target="">udviz/game_editor</a></div><div class="navbar-item"><a id="udviz/game_node-mobile" href="../game_node" target="">udviz/game_node</a></div><div class="navbar-item"><a id="udviz/game_node_template-mobile" href="../game_node_template" target="">udviz/game_node_template</a></div><div class="navbar-item"><a id="udviz/game_shared-mobile" href="../game_shared" target="">udviz/game_shared</a></div><div class="navbar-item"><a id="udviz/game_shared_template-mobile" href="../game_shared_template" target="">udviz/game_shared_template</a></div><div class="navbar-item"><a id="udviz/show_room-mobile" href="../show_room" target="">udviz/show_room</a></div><div class="navbar-item"><a id="udviz/smdb-mobile" href="../smdb" target="">udviz/smdb</a></div><div class="navbar-item"><a id="udviz/utils_browser-mobile" href="../utils_browser" target="">udviz/utils_browser</a></div><div class="navbar-item"><a id="udviz/utils_node-mobile" href="../utils_node" target="">udviz/utils_node</a></div><div class="navbar-item"><a id="udviz/utils_shared-mobile" href="../utils_shared" target="">udviz/utils_shared</a></div><div class="navbar-item"><a id="udviz/visualizer-mobile" href="../visualizer" target="">udviz/visualizer</a></div><div class="navbar-item"><a id="udviz/widget_3d_tiles-mobile" href="../widget_3d_tiles" target="">udviz/widget_3d_tiles</a></div><div class="navbar-item"><a id="udviz/widget_base_map-mobile" href="../widget_base_map" target="">udviz/widget_base_map</a></div><div class="navbar-item"><a id="udviz/widget_bookmark-mobile" href="../widget_bookmark" target="">udviz/widget_bookmark</a></div><div class="navbar-item"><a id="udviz/widget_camera_positioner-mobile" href="../widget_camera_positioner" target="">udviz/widget_camera_positioner</a></div><div class="navbar-item"><a id="udviz/widget_extensions_3d_tiles_temporal-mobile" href="../widget_extensions_3d_tiles_temporal" target="">udviz/widget_extensions_3d_tiles_temporal</a></div><div class="navbar-item"><a id="udviz/widget_geocoding-mobile" href="../widget_geocoding" target="">udviz/widget_geocoding</a></div><div class="navbar-item"><a id="udviz/widget_guided_tour-mobile" href="../widget_guided_tour" target="">udviz/widget_guided_tour</a></div><div class="navbar-item"><a id="udviz/widget_layer_choice-mobile" href="../widget_layer_choice" target="">udviz/widget_layer_choice</a></div><div class="navbar-item"><a id="udviz/widget_legonizer-mobile" href="../widget_legonizer" target="">udviz/widget_legonizer</a></div><div class="navbar-item"><a id="udviz/widget_planar_controls-mobile" href="../widget_planar_controls" target="">udviz/widget_planar_controls</a></div><div class="navbar-item"><a id="udviz/widget_slide_show-mobile" href="../widget_slide_show" target="">udviz/widget_slide_show</a></div><div class="navbar-item"><a id="udviz/widget_sparql-mobile" href="../widget_sparql" target="">udviz/widget_sparql</a></div><div class="navbar-item"><a id="udviz/widget_versioning-mobile" href="../widget_versioning" target="">udviz/widget_versioning</a></div><div class="navbar-item"><a id="udviz/widget_workspace-mobile" href="../widget_workspace" target="">udviz/widget_workspace</a></div></div><div class="mobile-sidebar-items-c"><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-classes"><div>Classes</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="AuthenticationView.html">AuthenticationView</a></div><div class="sidebar-section-children"><a href="ContributeModule.html">ContributeModule</a></div><div class="sidebar-section-children"><a href="ContributeService.html">ContributeService</a></div><div class="sidebar-section-children"><a href="DefaultDocumentSource.html">DefaultDocumentSource</a></div><div class="sidebar-section-children"><a href="Document.html">Document</a></div><div class="sidebar-section-children"><a href="DocumentCommentsModule.html">DocumentCommentsModule</a></div><div class="sidebar-section-children"><a href="DocumentCommentsService.html">DocumentCommentsService</a></div><div class="sidebar-section-children"><a href="DocumentCommentsWindow.html">DocumentCommentsWindow</a></div><div class="sidebar-section-children"><a href="DocumentCreationWindow.html">DocumentCreationWindow</a></div><div class="sidebar-section-children"><a href="DocumentFilter.html">DocumentFilter</a></div><div class="sidebar-section-children"><a href="DocumentInspectorWindow.html">DocumentInspectorWindow</a></div><div class="sidebar-section-children"><a href="DocumentModule.html">DocumentModule</a></div><div class="sidebar-section-children"><a href="DocumentNavigatorWindow.html">DocumentNavigatorWindow</a></div><div class="sidebar-section-children"><a href="DocumentProvider.html">DocumentProvider</a></div><div class="sidebar-section-children"><a href="DocumentSearchFilter.html">DocumentSearchFilter</a></div><div class="sidebar-section-children"><a href="DocumentService.html">DocumentService</a></div><div class="sidebar-section-children"><a href="DocumentSource.html">DocumentSource</a></div><div class="sidebar-section-children"><a href="DocumentUpdateWindow.html">DocumentUpdateWindow</a></div><div class="sidebar-section-children"><a href="DocumentValidationModule.html">DocumentValidationModule</a></div><div class="sidebar-section-children"><a href="DocumentView.html">DocumentView</a></div><div class="sidebar-section-children"><a href="DocumentVisualizerWindow.html">DocumentVisualizerWindow</a></div><div class="sidebar-section-children"><a href="DocumentsInValidationDocumentSource.html">DocumentsInValidationDocumentSource</a></div><div class="sidebar-section-children"><a href="GuidedTour.html">GuidedTour</a></div><div class="sidebar-section-children"><a href="GuidedTourController.html">GuidedTourController</a></div><div class="sidebar-section-children"><a href="ValidationService.html">ValidationService</a></div><div class="sidebar-section-children"><a href="ValidationView.html">ValidationView</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-tutorials"><div>Tutorials</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="tutorial-Changelog.html">Changelog</a></div><div class="sidebar-section-children"><a href="tutorial-Contributing.html">Contributing</a></div><div class="sidebar-section-children"><a href="tutorial-Contributors.html">Contributors</a></div><div class="sidebar-section-children"><a href="tutorial-Definitions.html">Definitions</a></div><div class="sidebar-section-children"><a href="tutorial-Developers.html">Developers</a></div><div class="sidebar-section-children"><a href="tutorial-ReleasePublish.html">ReleasePublish</a></div><div class="sidebar-section-children"><a href="tutorial-Reproducibility.html">Reproducibility</a></div><div class="sidebar-section-children"><a href="tutorial-architecture.html">architecture</a></div><div class="sidebar-section-children"><a href="tutorial-game.html">game</a></div><div class="sidebar-section-children"><a href="tutorial-how_to_import.html">how_to_import</a></div><div class="sidebar-section-children"><a href="tutorial-initial_camera_transform.html">initial_camera_transform</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-global"><div>Global</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="global.html#AuthenticationService">AuthenticationService</a></div><div class="sidebar-section-children"><a href="global.html#cbAccepts">cbAccepts</a></div><div class="sidebar-section-children"><a href="global.html#cbAction">cbAction</a></div></div></div><div class="mobile-navbar-actions"><div class="navbar-right-item"><button class="icon-button search-button" aria-label="open-search"><svg><use xlink:href="#search-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button theme-toggle" aria-label="toggle-theme"><svg><use class="theme-svg-use" xlink:href="#light-theme-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button font-size" aria-label="change-font-size"><svg><use xlink:href="#font-size-icon"></use></svg></button></div></div></div></div><script type="text/javascript" src="scripts/core.min.js"></script><script src="scripts/search.min.js" defer="defer"></script><script src="scripts/third-party/fuse.js" defer="defer"></script><script type="text/javascript">var tocbotInstance=tocbot.init({tocSelector:"#eed4d2a0bfd64539bb9df78095dec881",contentSelector:".main-content",headingSelector:"h1, h2, h3",hasInnerContainers:!0,scrollContainer:".main-content",headingsOffset:130,onClick:bringLinkToView})</script></body></html>