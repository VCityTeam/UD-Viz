<!DOCTYPE html><html lang="en" style="font-size:16px"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link type="text/css" rel="stylesheet" href="custom.css"><title>Home</title><!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]--><script src="scripts/third-party/hljs.js" defer="defer"></script><script src="scripts/third-party/hljs-line-num.js" defer="defer"></script><script src="scripts/third-party/popper.js" defer="defer"></script><script src="scripts/third-party/tippy.js" defer="defer"></script><script src="scripts/third-party/tocbot.min.js"></script><script>var baseURL="/",locationPathname="";baseURL=(locationPathname=document.location.pathname).substr(0,locationPathname.lastIndexOf("/")+1)</script><link rel="stylesheet" href="styles/clean-jsdoc-theme.min.css"><svg aria-hidden="true" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="display:none"><defs><symbol id="copy-icon" viewbox="0 0 488.3 488.3"><g><path d="M314.25,85.4h-227c-21.3,0-38.6,17.3-38.6,38.6v325.7c0,21.3,17.3,38.6,38.6,38.6h227c21.3,0,38.6-17.3,38.6-38.6V124    C352.75,102.7,335.45,85.4,314.25,85.4z M325.75,449.6c0,6.4-5.2,11.6-11.6,11.6h-227c-6.4,0-11.6-5.2-11.6-11.6V124    c0-6.4,5.2-11.6,11.6-11.6h227c6.4,0,11.6,5.2,11.6,11.6V449.6z"/><path d="M401.05,0h-227c-21.3,0-38.6,17.3-38.6,38.6c0,7.5,6,13.5,13.5,13.5s13.5-6,13.5-13.5c0-6.4,5.2-11.6,11.6-11.6h227    c6.4,0,11.6,5.2,11.6,11.6v325.7c0,6.4-5.2,11.6-11.6,11.6c-7.5,0-13.5,6-13.5,13.5s6,13.5,13.5,13.5c21.3,0,38.6-17.3,38.6-38.6    V38.6C439.65,17.3,422.35,0,401.05,0z"/></g></symbol><symbol id="search-icon" viewBox="0 0 512 512"><g><g><path d="M225.474,0C101.151,0,0,101.151,0,225.474c0,124.33,101.151,225.474,225.474,225.474    c124.33,0,225.474-101.144,225.474-225.474C450.948,101.151,349.804,0,225.474,0z M225.474,409.323    c-101.373,0-183.848-82.475-183.848-183.848S124.101,41.626,225.474,41.626s183.848,82.475,183.848,183.848    S326.847,409.323,225.474,409.323z"/></g></g><g><g><path d="M505.902,476.472L386.574,357.144c-8.131-8.131-21.299-8.131-29.43,0c-8.131,8.124-8.131,21.306,0,29.43l119.328,119.328    c4.065,4.065,9.387,6.098,14.715,6.098c5.321,0,10.649-2.033,14.715-6.098C514.033,497.778,514.033,484.596,505.902,476.472z"/></g></g></symbol><symbol id="font-size-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M11.246 15H4.754l-2 5H.6L7 4h2l6.4 16h-2.154l-2-5zm-.8-2L8 6.885 5.554 13h4.892zM21 12.535V12h2v8h-2v-.535a4 4 0 1 1 0-6.93zM19 18a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"/></symbol><symbol id="add-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M11 11V5h2v6h6v2h-6v6h-2v-6H5v-2z"/></symbol><symbol id="minus-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M5 11h14v2H5z"/></symbol><symbol id="dark-theme-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M10 7a7 7 0 0 0 12 4.9v.1c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2h.1A6.979 6.979 0 0 0 10 7zm-6 5a8 8 0 0 0 15.062 3.762A9 9 0 0 1 8.238 4.938 7.999 7.999 0 0 0 4 12z"/></symbol><symbol id="light-theme-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M12 18a6 6 0 1 1 0-12 6 6 0 0 1 0 12zm0-2a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM11 1h2v3h-2V1zm0 19h2v3h-2v-3zM3.515 4.929l1.414-1.414L7.05 5.636 5.636 7.05 3.515 4.93zM16.95 18.364l1.414-1.414 2.121 2.121-1.414 1.414-2.121-2.121zm2.121-14.85l1.414 1.415-2.121 2.121-1.414-1.414 2.121-2.121zM5.636 16.95l1.414 1.414-2.121 2.121-1.414-1.414 2.121-2.121zM23 11v2h-3v-2h3zM4 11v2H1v-2h3z"/></symbol><symbol id="reset-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M18.537 19.567A9.961 9.961 0 0 1 12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10c0 2.136-.67 4.116-1.81 5.74L17 12h3a8 8 0 1 0-2.46 5.772l.997 1.795z"/></symbol><symbol id="down-icon" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.7803 6.21967C13.0732 6.51256 13.0732 6.98744 12.7803 7.28033L8.53033 11.5303C8.23744 11.8232 7.76256 11.8232 7.46967 11.5303L3.21967 7.28033C2.92678 6.98744 2.92678 6.51256 3.21967 6.21967C3.51256 5.92678 3.98744 5.92678 4.28033 6.21967L8 9.93934L11.7197 6.21967C12.0126 5.92678 12.4874 5.92678 12.7803 6.21967Z"></path></symbol><symbol id="codepen-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M16.5 13.202L13 15.535v3.596L19.197 15 16.5 13.202zM14.697 12L12 10.202 9.303 12 12 13.798 14.697 12zM20 10.869L18.303 12 20 13.131V10.87zM19.197 9L13 4.869v3.596l3.5 2.333L19.197 9zM7.5 10.798L11 8.465V4.869L4.803 9 7.5 10.798zM4.803 15L11 19.131v-3.596l-3.5-2.333L4.803 15zM4 13.131L5.697 12 4 10.869v2.262zM2 9a1 1 0 0 1 .445-.832l9-6a1 1 0 0 1 1.11 0l9 6A1 1 0 0 1 22 9v6a1 1 0 0 1-.445.832l-9 6a1 1 0 0 1-1.11 0l-9-6A1 1 0 0 1 2 15V9z"/></symbol><symbol id="close-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M12 10.586l4.95-4.95 1.414 1.414-4.95 4.95 4.95 4.95-1.414 1.414-4.95-4.95-4.95 4.95-1.414-1.414 4.95-4.95-4.95-4.95L7.05 5.636z"/></symbol><symbol id="menu-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M3 4h18v2H3V4zm0 7h18v2H3v-2zm0 7h18v2H3v-2z"/></symbol></defs></svg></head><body data-theme="dark"><div class="sidebar-container"><div class="sidebar" id="sidebar"><a href="/" class="sidebar-title sidebar-title-anchor">@ud-viz/widget_sparql</a><div class="sidebar-items-container"><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-classes"><div>Classes</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="D3GraphCanvas_D3GraphCanvas.html">D3GraphCanvas</a></div><div class="sidebar-section-children"><a href="Graph.html">Graph</a></div><div class="sidebar-section-children"><a href="SparqlEndpointResponseProvider.html">SparqlEndpointResponseProvider</a></div><div class="sidebar-section-children"><a href="SparqlQuery.html">SparqlQuery</a></div><div class="sidebar-section-children"><a href="SparqlQueryWindow.html">SparqlQueryWindow</a></div><div class="sidebar-section-children"><a href="Table.html">Table</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-tutorials"><div>Tutorials</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="tutorial-Changelog.html">Changelog</a></div><div class="sidebar-section-children"><a href="tutorial-Contributing.html">Contributing</a></div><div class="sidebar-section-children"><a href="tutorial-Contributors.html">Contributors</a></div><div class="sidebar-section-children"><a href="tutorial-Definitions.html">Definitions</a></div><div class="sidebar-section-children"><a href="tutorial-Developers.html">Developers</a></div><div class="sidebar-section-children"><a href="tutorial-ReleasePublish.html">ReleasePublish</a></div><div class="sidebar-section-children"><a href="tutorial-Reproducibility.html">Reproducibility</a></div><div class="sidebar-section-children"><a href="tutorial-architecture.html">architecture</a></div><div class="sidebar-section-children"><a href="tutorial-game.html">game</a></div><div class="sidebar-section-children"><a href="tutorial-how_to_import.html">how_to_import</a></div><div class="sidebar-section-children"><a href="tutorial-initial_camera_transform.html">initial_camera_transform</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-global"><div>Global</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="global.html#OptionsRenderJSON">OptionsRenderJSON</a></div></div></div></div></div><div class="navbar-container" id="VuAckcnZhf"><nav class="navbar"><div class="navbar-left-items"><div class="navbar-item"><a id="Github" href="https://github.com/VCityTeam/UD-Viz" target="_blank">Github</a></div><div class="navbar-item"><a id="Examples" href="https://ud-viz.vcityliris.data.alpha.grandlyon.com/" target="_blank">Examples</a></div><div class="navbar-item"><a id="udvizHome" href="../" target="">udviz</a></div><div class="navbar-item"><a id="udviz/extensions_3d_tiles_temporal" href="../extensions_3d_tiles_temporal" target="">udviz/extensions_3d_tiles_temporal</a></div><div class="navbar-item"><a id="udviz/frame3d" href="../frame3d" target="">udviz/frame3d</a></div><div class="navbar-item"><a id="udviz/game_browser" href="../game_browser" target="">udviz/game_browser</a></div><div class="navbar-item"><a id="udviz/game_browser_template" href="../game_browser_template" target="">udviz/game_browser_template</a></div><div class="navbar-item"><a id="udviz/game_editor" href="../game_editor" target="">udviz/game_editor</a></div><div class="navbar-item"><a id="udviz/game_node" href="../game_node" target="">udviz/game_node</a></div><div class="navbar-item"><a id="udviz/game_node_template" href="../game_node_template" target="">udviz/game_node_template</a></div><div class="navbar-item"><a id="udviz/game_shared" href="../game_shared" target="">udviz/game_shared</a></div><div class="navbar-item"><a id="udviz/game_shared_template" href="../game_shared_template" target="">udviz/game_shared_template</a></div><div class="navbar-item"><a id="udviz/show_room" href="../show_room" target="">udviz/show_room</a></div><div class="navbar-item"><a id="udviz/smdb" href="../smdb" target="">udviz/smdb</a></div><div class="navbar-item"><a id="udviz/utils_browser" href="../utils_browser" target="">udviz/utils_browser</a></div><div class="navbar-item"><a id="udviz/utils_node" href="../utils_node" target="">udviz/utils_node</a></div><div class="navbar-item"><a id="udviz/utils_shared" href="../utils_shared" target="">udviz/utils_shared</a></div><div class="navbar-item"><a id="udviz/visualizer" href="../visualizer" target="">udviz/visualizer</a></div><div class="navbar-item"><a id="udviz/widget_3d_tiles" href="../widget_3d_tiles" target="">udviz/widget_3d_tiles</a></div><div class="navbar-item"><a id="udviz/widget_base_map" href="../widget_base_map" target="">udviz/widget_base_map</a></div><div class="navbar-item"><a id="udviz/widget_bookmark" href="../widget_bookmark" target="">udviz/widget_bookmark</a></div><div class="navbar-item"><a id="udviz/widget_camera_positioner" href="../widget_camera_positioner" target="">udviz/widget_camera_positioner</a></div><div class="navbar-item"><a id="udviz/widget_extensions_3d_tiles_temporal" href="../widget_extensions_3d_tiles_temporal" target="">udviz/widget_extensions_3d_tiles_temporal</a></div><div class="navbar-item"><a id="udviz/widget_geocoding" href="../widget_geocoding" target="">udviz/widget_geocoding</a></div><div class="navbar-item"><a id="udviz/widget_guided_tour" href="../widget_guided_tour" target="">udviz/widget_guided_tour</a></div><div class="navbar-item"><a id="udviz/widget_layer_choice" href="../widget_layer_choice" target="">udviz/widget_layer_choice</a></div><div class="navbar-item"><a id="udviz/widget_legonizer" href="../widget_legonizer" target="">udviz/widget_legonizer</a></div><div class="navbar-item"><a id="udviz/widget_planar_controls" href="../widget_planar_controls" target="">udviz/widget_planar_controls</a></div><div class="navbar-item"><a id="udviz/widget_slide_show" href="../widget_slide_show" target="">udviz/widget_slide_show</a></div><div class="navbar-item"><a id="udviz/widget_sparql" href="../widget_sparql" target="">udviz/widget_sparql</a></div><div class="navbar-item"><a id="udviz/widget_versioning" href="../widget_versioning" target="">udviz/widget_versioning</a></div><div class="navbar-item"><a id="udviz/widget_workspace" href="../widget_workspace" target="">udviz/widget_workspace</a></div></div><div class="navbar-right-items"><div class="navbar-right-item"><button class="icon-button search-button" aria-label="open-search"><svg><use xlink:href="#search-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button theme-toggle" aria-label="toggle-theme"><svg><use class="theme-svg-use" xlink:href="#light-theme-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button font-size" aria-label="change-font-size"><svg><use xlink:href="#font-size-icon"></use></svg></button></div></div><nav></nav></nav></div><div class="toc-container"><div class="toc-content"><span class="bold">On this page</span><div id="eed4d2a0bfd64539bb9df78095dec881"></div></div></div><div class="body-wrapper"><div class="main-content"><div class="main-wrapper"><section class="readme"><article><h1 id="%40ud-viz%2Fwidget_sparql">@ud-viz/widget_sparql</h1><p><a href="https://npmjs.com/package/@ud-viz/widget_sparql"><img src="https://badgen.net/npm/v/@ud-viz/widget_sparql" alt="NPM package version"></a></p><h2 id="sparql-module">SPARQL Module</h2><p>The SPARQL Module adds basic functionality to query and visualize Semantic Web data stored in a Strabon Triple-store from a UD-Viz interface.</p><h2 id="basic-functionalities">Basic functionalities</h2><p>The basic functionalities of the SPARQL module include:</p><ul><li>Query a <a href="https://github.com/VCityTeam/UD-SV/blob/master/Vocabulary/Readme.md#SPARQL-Endpoint">SPARQL Endpoint</a> via HTTP request.</li><li>Data is returned in the form of RDF and vizualised with <a href="https://d3js.org/">D3.js</a> as a graph.</li><li>The vizualised graph data can be used to select, focus on, and highlight corresponding to city objects.</li></ul><h2 id="installation">Installation</h2><p>You can install the package via npm:</p><pre class="prettyprint source lang-bash"><code>npm install @ud-viz/widget_sparql
</code></pre><h2 id="usage">Usage</h2><p>For an example of how to the SPARQL Widget to a UD-Viz web application see the <a href="https://github.com/VCityTeam/UD-Viz/blob/master/examples/widget_sparql.html">SPARQLWidget example</a></p><h3 id="user-interface">User Interface</h3><p>The Interface is composed of a <strong>SPARQL Query</strong> window containing a text box for composing queries to send to a <a href="https://github.com/VCityTeam/UD-SV/blob/master/Vocabulary/Readme.md#SPARQL-Endpoint">SPARQL Endpoint</a>.</p><p><img src="./img/interface.png" alt="SPARQL widget interface"></p><p>The <em>Results Format</em> dropdown menu can be used to select how the query results will be visualised. Currently 3 formats are supported:</p><ul><li><a href="#graph-view">Graph</a></li><li><a href="#table">Table</a></li><li><a href="#json">JSON</a></li></ul><h4 id="graph-view">Graph View</h4><p>A displayed graph can be zoomed in and out using the mouse wheel and panned by clicking and dragging the background of the graph. In addition, nodes can be moved by clicking and dragging them.</p><p><img src="./img/sparql-widget-demo.gif" alt="Vizualize SPARQL query result in D3"></p><p>In order to propery colorize the nodes of a graph a SPARQL query must be formulated following a simple subject-predicate-object <a href="https://github.com/VCityTeam/UD-SV/blob/master/Vocabulary/Readme.md#triple">RDF triple</a> structure. Colors will be assigned as a function each node's <code>rdf:type</code>. Thus 4 data must be selected:</p><ul><li>?subject</li><li>?object</li><li>?predicate</li><li>?subjectType</li><li>?objectType</li></ul><p>For example the following query on <a href="https://github.com/VCityTeam/UD-Graph/blob/sparql-demo/SPARQL_Demo/data/LYON_1ER_BATI_2015-20_bldg-patched.rdf">this</a> RDF dataset returns all building city objects in a city model:</p><pre class="prettyprint source lang-sql"><code>PREFIX rdf:  &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#>
PREFIX owl:  &lt;http://www.w3.org/2002/07/owl#>
PREFIX xsd:  &lt;http://www.w3.org/2001/XMLSchema#>
PREFIX gmlowl:  &lt;http://www.opengis.net/ont/gml#>
PREFIX units: &lt;http://www.opengis.net/def/uom/OGC/1.0/>
PREFIX geo: &lt;http://www.opengis.net/ont/geosparql#>
PREFIX geof: &lt;http://www.opengis.net/def/function/geosparql/>
PREFIX strdf: &lt;http://strdf.di.uoa.gr/ontology#>
PREFIX skos: &lt;http://www.w3.org/2004/02/skos/core#>
PREFIX core: &lt;http://www.opengis.net/citygml/2.0/core#>
PREFIX bldg: &lt;http://www.opengis.net/citygml/building/2.0/building#>

# Return all CityGML City Objects
SELECT ?subject ?subjectType ?predicate ?object ?objectType
WHERE {
  ?subject a core:CityModel ;
    ?predicate ?object .
  ?subject a ?subjectType .
  ?object a bldg:Building .
  ?object a ?objectType .

  FILTER(?subjectType != &lt;http://www.w3.org/2002/07/owl#NamedIndividual>)
  FILTER(?objectType != &lt;http://www.w3.org/2002/07/owl#NamedIndividual>)
}
</code></pre><p>An example of the visualization of this query:</p><p><img src="./img/pickcityobjectfromgraph.gif" alt="Pick City Object from Graph"></p><h4 id="table">Table</h4><p>The table view features a filter for searching for data within a column. In addition rows can be sorted in ascending or descending order by column. The table also provides features for filtering and ordering the table contents.</p><p><img src="./img/sparql-widget-table-demo.gif" alt="Table view demonstraction"></p><h4 id="json">JSON</h4><p>The JSON view returns a collapsible representation of the query reponse.</p><p><img src="./img/sparql-widget-json-demo.gif" alt="JSON view demonstraction"></p><h4 id="customizing-events-with-d3">Customizing events with D3</h4><p>D3 provides event handlers for when users interact with elements of the visualized data. These events can be used to add functionality to the interface depending on the needs of an application.</p><p>In the example below, the URIs of nodes in the graph correspond with identifiers of objects in the tileset batch table.</p><ul><li><em>mouseover</em> and <em>mouseout</em> events are used to highlight the corresponding geometry of the object in the 3D scene.</li><li>A <em>click</em> event is used to zoom in on the corresponding geometry.</li></ul><p><img src="./img/node-event-example.gif" alt="an example of customized D3 mouse events"></p><p>To see how this can be done check out the <a href="./../../examples/widget_sparql.html">SPARQL module example</a></p><h2 id="code-architecture">Code architecture</h2><p>The SPARQL code is divided into 3 subfolders:</p><pre class="prettyprint source lang-mermaid"><code>flowchart TD
  A(SPARQL) --> Model
  A(SPARQL) --> Server
  A(SPARQL) --> View
</code></pre><ul><li>The model classes are responsible for providing data structures for storing and formating the data returned by the server.<ul><li>The <code>Table</code> and <code>Graph</code> classes use the <a href="https://d3js.org/">D3.js</a> library to provide data structures for formating data from the <code>SparqlEndpointService</code>.</li><li>The <code>URI</code> class provides a data structure for storing URI strings.</li></ul></li><li>The server classes are responsible for providing an interface or adapter for transmitting data between the other module classes and the server.<ul><li>The class responsible for making the requests is the <code>SparqlEndpointService</code>. Using a SPARQL query, it fetches <a href="https://github.com/VCityTeam/UD-SV/blob/master/Vocabulary/Readme.md#resource-description-framework">RDF</a> data from the server as a JSON Object data structure.</li><li>The <code>SparqlEndpointResponseProvider</code> is an <code>EventSender</code> for informing classes subscribed to its events, when the <code>SparqlEndpointService</code> sends or receives data.</li></ul></li><li>The view is responsible for displaying the data retrieved from the view model and providing a user interface. It has a <code>SparqlWidgetView</code> class which manages a <code>SparqlQueryWindow</code> window class. This window is responsible for providing the user a form for entering and executing queries using the <code>SparqlEndpointResponseProvider</code> class and vizualising the data returned by the provider.</li></ul><h2 id="module-configuration">Module Configuration</h2><p>The module takes two configuration files:</p><ol><li>Server configuration</li><li>Widget (view+model) configuration</li></ol><h3 id="widget-configuration">Widget Configuration</h3><p>The minimal configuration required to make a SPARQL server class work is the following :</p><pre class="prettyprint source lang-json"><code>{
  &quot;url&quot;: &quot;http://localhost:9999/strabon/&quot;,
  &quot;url_parameters&quot;: &quot;Query?handle=download&format=SPARQL/JSON&view=HTML&query=&quot;
}
</code></pre><ul><li><code>sparqlModule.url</code> represents the base URL for the server.</li><li><code>sparqlModule.url_parameters</code> represents the URL parameters to query the server via an HTTP request.</li></ul><p>The SPARQL Query Service for interfacing with Strabon expects the URL to correspond to a REST API, where query routes are in the form <code>{url}{url_parameters}</code></p><p>Parameters can also be configured to define custom queries in the interface: See the <a href="https://vcityteam.github.io/UD-Viz/html/browser/SparqlEndpointService.html">SparqlEndpointService</a> documentation for more information</p><h3 id="view%2Fmodel-configuration">View/Model Configuration</h3><p>The minimal configuration required to make a SPARQL Widget class work is the following :</p><pre class="prettyprint source lang-json"><code>{
  &quot;height&quot;: 500,
  &quot;width&quot;: 500,
  &quot;fontSize&quot;: 4
  &quot;fontFamily&quot;: &quot;Arial&quot;,
  &quot;strokeWidth&quot;: 0.75,
  &quot;nodeSize&quot;: 7,
  &quot;defaultColor&quot;: &quot;#dedede&quot;,
  &quot;linkColor&quot;: &quot;#999&quot;,
  &quot;nodeStrokeColor&quot;: &quot;black&quot;,
  &quot;fontSizeLegend&quot;: 14,
}
</code></pre><ul><li><code>height</code> the height (in pixels) of a d3 canvas for visualizing graphs</li><li><code>width</code> the width (in pixels) of a d3 canvas for visualizing graphs</li><li><code>fontSize</code> fontsize to be used in the d3 canvas for labeling graph nodes</li><li><code>fontFamily</code> fontfamily to be used in the d3 canvas for labeling graph nodes</li><li><code>strokeWidth</code> the width (in pixels) of the color of the nodes' and links' stroke</li><li><code>nodeSize</code> the radius (in pixels) of the circles representing the nodes</li><li><code>defaultColor</code> the color of the nodes without the property <code>color_id</code></li><li><code>linkColor</code> the color of the links</li><li><code>nodeStrokeColor</code> the color of the nodes' stroke</li><li><code>fontSizeLegend</code> fontsize to be used in the d3 canvas for displaying the legend</li></ul><p>Parameters can also be configured to use custom labels instead of full URI namespaces in the legend.</p><pre class="prettyprint source lang-json"><code>{
    &quot;namespaceLabels&quot;: {
      &quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#&quot;: &quot;rdf&quot;,
      &quot;http://www.w3.org/2000/01/rdf-schema#&quot;: &quot;rdfs&quot;,
      &quot;http://www.w3.org/2002/07/owl#&quot;: &quot;owl&quot;,
      &quot;http://www.w3.org/2004/02/skos/core#&quot;: &quot;skos&quot;,
      &quot;http://www.opengis.net/gml#&quot;: &quot;gml&quot;,
      &quot;http://www.opengis.net/ont/geosparql#&quot;: &quot;geo&quot;,
      &quot;https://raw.githubusercontent.com/VCityTeam/UD-Graph/master/Ontologies/Workspace/3.0/transactiontypes#&quot;: &quot;type&quot;,
      &quot;https://dataset-dl.liris.cnrs.fr/rdf-owl-urban-data-ontologies/Ontologies/CityGML/3.0/building#&quot;: &quot;bldg&quot;,
      &quot;https://dataset-dl.liris.cnrs.fr/rdf-owl-urban-data-ontologies/Ontologies/CityGML/3.0/construction#&quot;: &quot;con&quot;,
      &quot;http://def.isotc211.org/iso19107/2003/CoordinateGeometry#&quot;: &quot;iso19107-cm&quot;,
  }
}
</code></pre><p>It is also possible to configure custom queries. You can either define a query with the <code>exploration</code> attribute or the <code>filepath</code> attribute:</p><ul><li>the <code>filepath</code> attribute is used to specify a path to a file in which a sparql query has already been written</li><li>the <code>exploration</code> attribute is used to set the context for queries updated gradually by the user thanks to the <code>SparqlQuery.js</code> class and the method <code>updateExplorationQuery</code> of the <code>SparqlQueryWidget.js</code> class</li></ul><p>When an exploration query is selected, clicking on an element in the 3D scene adds the corresponding node and its children to the graph.</p><pre class="prettyprint source lang-json"><code>{
  &quot;queries&quot;: [
      {
        &quot;title&quot;: &quot;Exploration query&quot;,
        &quot;formats&quot;: {
          &quot;graph&quot;: &quot;Graph&quot;,
          &quot;json&quot;: &quot;JSON&quot;
        },
        &quot;exploration&quot;: {
          &quot;prefix&quot;: [
            [&quot;bldg&quot;, &quot;https://dataset-dl.liris.cnrs.fr/rdf-owl-urban-data-ontologies/Ontologies/CityGML/2.0/building#&quot;],
            [&quot;skos&quot;, &quot;http://www.w3.org/2004/02/skos/core#&quot;],
            [&quot;data&quot;, &quot;https://dataset-dl.liris.cnrs.fr/rdf-owl-urban-data-ontologies/Datasets/Villeurbanne/2018/GratteCiel_2018_split#&quot;]
          ],
          &quot;select_variable&quot;: [
            &quot;subject&quot;,
            &quot;subjectType&quot;,
            &quot;predicate&quot;,
            &quot;object&quot;,
            &quot;objectType&quot;
          ],
          &quot;options&quot;: [
            [&quot;FILTER&quot;, &quot;?subjectType != owl:NamedIndividual&quot;],
            [&quot;FILTER&quot;, &quot;!bound(?objectType) || ?objectType != owl:NamedIndividual&quot;],
            [&quot;FILTER&quot;, &quot;?subject != owl:NamedIndividual&quot;],
            [&quot;FILTER&quot;, &quot;?object != owl:NamedIndividual&quot;]
          ]
        }
      },
      {
        &quot;title&quot;: &quot;Construct query&quot;,
        &quot;formats&quot;: {
          &quot;graph&quot;: &quot;Graph&quot;,
          &quot;json&quot;: &quot;JSON&quot;
        },
        &quot;filepath&quot;: &quot;./assets/queries/construct.rq&quot;
      }
    ]
  }
</code></pre><h2 id="the-d3graphcanvas.js-class">The D3GraphCanvas.js class</h2><p>Two new parameters have been added to the <code>D3GraphCanvas.js</code> class:</p><ul><li>the handleZoom function for configuring zoom management in the graph</li><li>the formatResponse function for formatting the JSON response into node and link objects</li></ul><p>The formatResponse function should add the nodes and links to the attributes <code>nodes</code> and <code>links</code> of the instance of <code>Graph.js</code>.</p><pre class="prettyprint source lang-js"><code>data.nodes = [
  {
    id: &quot;node's id&quot;,
    type: &quot;node's type&quot;, // OPTIONAL 
    color_id: &quot;node's color in hex&quot;, // OPTIONAL 
  },
]

data.links = [
  {
    source: &quot;source node's id&quot;,
    target: &quot;target node's id&quot;, 
    label: &quot;link's label&quot; 
  },
]

</code></pre><p>It can also define the <code>legend</code> attribute of the Graph <code>data</code>.</p><pre class="prettyprint source lang-js"><code>data.legend = [
  {
    type: &quot;description&quot;,
    color: &quot;color to the rectangle associated to the description&quot;, 
  },
]
</code></pre><p>Two default parameters are defined to handle the zoom and format the response returned by an instance of the <code>SparqlEndpointResponseProvider.js</code> class.</p><h2 id="the-sparqlquery.js-class">The SparqlQuery.js class</h2><p>The SPARQL query class is used for writing SPARQL queries based on defined conditions. Here are the conditions that can be defined:</p><ul><li>the variables following the SELECT statement</li><li>the conditions in the WHERE clause</li><li>the different options and filters of the query</li><li>the prefixes</li></ul><p>Then, the method <code>generateQuery</code> builds and returns the corresponding query.</p><p>Here is the architecture of the built query:</p><pre class="prettyprint source lang-rq"><code>[prefix]
SELECT ?select_variable[0] , ?select_variable[1] , ...
WHERE
{
  {
    where_conditions[0]
  } UNION {
    where_conditions[1]
  } UNION {
    ...
  }
  options[0][0] { options[0][1] } # options[0][0] = OPTIONAL
  options[1][0] ( options[1][1] ) # options[1][0] = FILTER
  ...
}
</code></pre><h2 id="documentation">Documentation</h2><blockquote><p><a href="https://vcityteam.github.io/UD-Viz/html/widget_sparql/">Online Documentation</a></p></blockquote><h2 id="contributing">Contributing</h2><p>Contributions are welcome! Feel free to submit bug reports, feature requests, or pull requests on the GitHub repository. See <a href="https://github.com/VCityTeam/UD-Viz/blob/master/docs/static/Contributing.md">Contributing.md</a>.</p><h2 id="license">License</h2><p>This package is licensed under the <a href="https://github.com/VCityTeam/UD-Viz/blob/master/LICENSE.md">GNU Lesser General Public License Version 2.1</a>, with copyright attributed to the University of Lyon.</p><h2 id="credits">Credits</h2><p><code>@ud-viz/widget_sparql</code> is developed and maintained by <a href="https://github.com/VCityTeam">VCityTeam</a>. See <a href="https://github.com/VCityTeam/UD-Viz/blob/master/docs/static/Contributors.md">Contributors.md</a>.</p><script src="../js/jsdoc-tuts-mermaid.js"></script></article></section><footer class="footer" id="PeOAagUepe"><div class="wrapper">Fork: <a href="https://github.com/VCityTeam/UD-Viz">https://github.com/VCityTeam/UD-Viz</a></div></footer></div></div></div><div class="search-container" id="PkfLWpAbet" style="display:none"><div class="wrapper" id="iCxFxjkHbP"><button class="icon-button search-close-button" id="VjLlGakifb" aria-label="close search"><svg><use xlink:href="#close-icon"></use></svg></button><div class="search-box-c"><svg><use xlink:href="#search-icon"></use></svg> <input type="text" id="vpcKVYIppa" class="search-input" placeholder="Search..." autofocus></div><div class="search-result-c" id="fWwVHRuDuN"><span class="search-result-c-text">Type anything to view search result</span></div></div></div><div class="mobile-menu-icon-container"><button class="icon-button" id="mobile-menu" data-isopen="false" aria-label="menu"><svg><use xlink:href="#menu-icon"></use></svg></button></div><div id="mobile-sidebar" class="mobile-sidebar-container"><div class="mobile-sidebar-wrapper"><a href="/" class="sidebar-title sidebar-title-anchor">@ud-viz/widget_sparql</a><div class="mobile-nav-links"><div class="navbar-item"><a id="Github-mobile" href="https://github.com/VCityTeam/UD-Viz" target="_blank">Github</a></div><div class="navbar-item"><a id="Examples-mobile" href="https://ud-viz.vcityliris.data.alpha.grandlyon.com/" target="_blank">Examples</a></div><div class="navbar-item"><a id="udvizHome-mobile" href="../" target="">udviz</a></div><div class="navbar-item"><a id="udviz/extensions_3d_tiles_temporal-mobile" href="../extensions_3d_tiles_temporal" target="">udviz/extensions_3d_tiles_temporal</a></div><div class="navbar-item"><a id="udviz/frame3d-mobile" href="../frame3d" target="">udviz/frame3d</a></div><div class="navbar-item"><a id="udviz/game_browser-mobile" href="../game_browser" target="">udviz/game_browser</a></div><div class="navbar-item"><a id="udviz/game_browser_template-mobile" href="../game_browser_template" target="">udviz/game_browser_template</a></div><div class="navbar-item"><a id="udviz/game_editor-mobile" href="../game_editor" target="">udviz/game_editor</a></div><div class="navbar-item"><a id="udviz/game_node-mobile" href="../game_node" target="">udviz/game_node</a></div><div class="navbar-item"><a id="udviz/game_node_template-mobile" href="../game_node_template" target="">udviz/game_node_template</a></div><div class="navbar-item"><a id="udviz/game_shared-mobile" href="../game_shared" target="">udviz/game_shared</a></div><div class="navbar-item"><a id="udviz/game_shared_template-mobile" href="../game_shared_template" target="">udviz/game_shared_template</a></div><div class="navbar-item"><a id="udviz/show_room-mobile" href="../show_room" target="">udviz/show_room</a></div><div class="navbar-item"><a id="udviz/smdb-mobile" href="../smdb" target="">udviz/smdb</a></div><div class="navbar-item"><a id="udviz/utils_browser-mobile" href="../utils_browser" target="">udviz/utils_browser</a></div><div class="navbar-item"><a id="udviz/utils_node-mobile" href="../utils_node" target="">udviz/utils_node</a></div><div class="navbar-item"><a id="udviz/utils_shared-mobile" href="../utils_shared" target="">udviz/utils_shared</a></div><div class="navbar-item"><a id="udviz/visualizer-mobile" href="../visualizer" target="">udviz/visualizer</a></div><div class="navbar-item"><a id="udviz/widget_3d_tiles-mobile" href="../widget_3d_tiles" target="">udviz/widget_3d_tiles</a></div><div class="navbar-item"><a id="udviz/widget_base_map-mobile" href="../widget_base_map" target="">udviz/widget_base_map</a></div><div class="navbar-item"><a id="udviz/widget_bookmark-mobile" href="../widget_bookmark" target="">udviz/widget_bookmark</a></div><div class="navbar-item"><a id="udviz/widget_camera_positioner-mobile" href="../widget_camera_positioner" target="">udviz/widget_camera_positioner</a></div><div class="navbar-item"><a id="udviz/widget_extensions_3d_tiles_temporal-mobile" href="../widget_extensions_3d_tiles_temporal" target="">udviz/widget_extensions_3d_tiles_temporal</a></div><div class="navbar-item"><a id="udviz/widget_geocoding-mobile" href="../widget_geocoding" target="">udviz/widget_geocoding</a></div><div class="navbar-item"><a id="udviz/widget_guided_tour-mobile" href="../widget_guided_tour" target="">udviz/widget_guided_tour</a></div><div class="navbar-item"><a id="udviz/widget_layer_choice-mobile" href="../widget_layer_choice" target="">udviz/widget_layer_choice</a></div><div class="navbar-item"><a id="udviz/widget_legonizer-mobile" href="../widget_legonizer" target="">udviz/widget_legonizer</a></div><div class="navbar-item"><a id="udviz/widget_planar_controls-mobile" href="../widget_planar_controls" target="">udviz/widget_planar_controls</a></div><div class="navbar-item"><a id="udviz/widget_slide_show-mobile" href="../widget_slide_show" target="">udviz/widget_slide_show</a></div><div class="navbar-item"><a id="udviz/widget_sparql-mobile" href="../widget_sparql" target="">udviz/widget_sparql</a></div><div class="navbar-item"><a id="udviz/widget_versioning-mobile" href="../widget_versioning" target="">udviz/widget_versioning</a></div><div class="navbar-item"><a id="udviz/widget_workspace-mobile" href="../widget_workspace" target="">udviz/widget_workspace</a></div></div><div class="mobile-sidebar-items-c"><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-classes"><div>Classes</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="D3GraphCanvas_D3GraphCanvas.html">D3GraphCanvas</a></div><div class="sidebar-section-children"><a href="Graph.html">Graph</a></div><div class="sidebar-section-children"><a href="SparqlEndpointResponseProvider.html">SparqlEndpointResponseProvider</a></div><div class="sidebar-section-children"><a href="SparqlQuery.html">SparqlQuery</a></div><div class="sidebar-section-children"><a href="SparqlQueryWindow.html">SparqlQueryWindow</a></div><div class="sidebar-section-children"><a href="Table.html">Table</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-tutorials"><div>Tutorials</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="tutorial-Changelog.html">Changelog</a></div><div class="sidebar-section-children"><a href="tutorial-Contributing.html">Contributing</a></div><div class="sidebar-section-children"><a href="tutorial-Contributors.html">Contributors</a></div><div class="sidebar-section-children"><a href="tutorial-Definitions.html">Definitions</a></div><div class="sidebar-section-children"><a href="tutorial-Developers.html">Developers</a></div><div class="sidebar-section-children"><a href="tutorial-ReleasePublish.html">ReleasePublish</a></div><div class="sidebar-section-children"><a href="tutorial-Reproducibility.html">Reproducibility</a></div><div class="sidebar-section-children"><a href="tutorial-architecture.html">architecture</a></div><div class="sidebar-section-children"><a href="tutorial-game.html">game</a></div><div class="sidebar-section-children"><a href="tutorial-how_to_import.html">how_to_import</a></div><div class="sidebar-section-children"><a href="tutorial-initial_camera_transform.html">initial_camera_transform</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="sidebar-global"><div>Global</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="global.html#OptionsRenderJSON">OptionsRenderJSON</a></div></div></div><div class="mobile-navbar-actions"><div class="navbar-right-item"><button class="icon-button search-button" aria-label="open-search"><svg><use xlink:href="#search-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button theme-toggle" aria-label="toggle-theme"><svg><use class="theme-svg-use" xlink:href="#light-theme-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button font-size" aria-label="change-font-size"><svg><use xlink:href="#font-size-icon"></use></svg></button></div></div></div></div><script type="text/javascript" src="scripts/core.min.js"></script><script src="scripts/search.min.js" defer="defer"></script><script src="scripts/third-party/fuse.js" defer="defer"></script><script type="text/javascript">var tocbotInstance=tocbot.init({tocSelector:"#eed4d2a0bfd64539bb9df78095dec881",contentSelector:".main-content",headingSelector:"h1, h2, h3",hasInnerContainers:!0,scrollContainer:".main-content",headingsOffset:130,onClick:bringLinkToView})</script></body></html>